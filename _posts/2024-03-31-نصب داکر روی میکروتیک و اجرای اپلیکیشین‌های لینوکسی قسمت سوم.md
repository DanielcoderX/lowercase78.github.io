---
layout: post
tags: [Mikrotik]
author: Kian
categories: Mikrotik
feature-img: "assets/img/header/internet-medium.jpeg"
---
تا اینجا نحوه ران کردن لینوکس Alpine رو یاد گرفتیم ، حالا میریم که اپلیکیشنهای مورد نظرمون رو روش ران کنیم : 

<p align="center">
<img src="/assets/images/mikrotik/container1.png" alt="container1.png">
</p>

برای ورود به محیط شل میتونید از همون ترمینال میکروتیک استفاده کنید ولی اگه دوست داشتین با اپلیکیشن SSH همیشگیتون مثلا Putty هم میشه به میکروتیک SSH بزنید و اونجا دستور ورود به محیط شل رو ران کنید ..

<p align="center">
<img src="/assets/images/mikrotik/shell.png" alt="shell.png">
</p>

```
/container/shell 0
```

دقت کنید: چالشی که پیش میاد اینه که چطور از میکروتیک ترافیک رو روی کانتاینر عبور بدیم ، برای لینوکس دیدم که با IP Table  میان ترافیک رو به یه پورت خاص ( ترنسپرنت پراکسی ) هدایت میکنن ولی تا جایی که من بلدم ( که اونم خیلی محدوده ) نمیشه IP Tables رو روی میکروتیک اجرا کرد ، دسترسی مربوطه رو نداره ..

من راه‌های زیادی رو رفتم و تا امروز بهترین روشی که تونستم روی میکروتیک اجرا کنم استفاده از کانتاینر به صورت تانل بوده .

با توجه به موارد بالا و قابلیت های میکروتیک من سه تا پروتکل Wiregaurd و OpenVPN و SSTP رو به عنوان پایه در نظر گرفتم و برای سادگی مطلب میام از سرورهای موجود اوپن‌گیت‌وی استفاده میکنم


```
http://opengw.net  
```

اول از همه هسته ایکس ری رو روی کانتاینر بالا میارم و ازش به عنوان فرگمنت استفاده میکنم و با میکروتیک باهاش SSTP میسازم:

برای راحتی کار من قبلا هسته ایکس ری رو از سورس اصلی دانلود کردم و اکسترکت کردم و توی گیت‌هابم آپلود کردم شما اگه خواستین خودتون برای خودتون دانلود کنید..

به ترتیب دستورات زیر رو بزنید تا ایکس ری توی کانتاینر نصب بشه :


```
cd /usr/local/bin
wget wget https://raw.githubusercontent.com/lowercase78/Mikrotik-App/main/xray
chmod +x xray
```

اگه دستور زیر رو بزنین باید نسخه xray رو به شما نمایش بده :

```
xray -version
```

خوب حالا به دایرکتوری root میریم و یه کانفیگ برای xray ایجاد میکنیم ..

میتونید برای شروع از کانفیگ من استفاده کنید :

```
cd /root
wget https://raw.githubusercontent.com/lowercase78/lowercase78.github.io/main/assets/other/config.json
```

میتونید با دستور زیر ایکس‌ری رو اجرا کنید و لاگش رو ببینید :

```
xray run -c config.json
```

بعد تست و اتمام کارمون با ایکس ری میریم که تنظیمات رو روی کانتاینر انجام بدیم ، کافیه تنظیمات رو به شکل زیر در بیارین و استارت کنید :


<p align="center">
<img src="/assets/images/mikrotik/xray.png" alt="xray.png">
</p>

اگه گزینه لاگ رو روشن کنید توی لاگ میکروتیک میتونید ببینید که ایکس‌ری ران شده،

کافیه یه کانفیگ از سایت opengw.net بگیرید و به عنوان SSTP برای میکروتیک تعریف کنید ، اینبار فرقس که داره با تنظیم  ایکس‌ری به عنوان پراکسی sstp رو با فرگمنت عبور دادیم و احتمال وصل شدن خیلی بیشتر از قبل هست .

<p align="center">
<img src="/assets/images/mikrotik/vpngate.png" alt="vpngate.png">
</p>


قاعدتا این روش بهترین روش برای وصل شدن نیست ولی برای شروع و آشنایی با نحوه اجرای کانتاینر در میکروتیک بد نیست .

تو آموزشهای بعدی روشهای ترکیبی دیگه‌ای که تست کردم رو باهاتون به اشتراک میزارم .

از جمله مواردی که تست شده میتونم Bepass , Gost , Sing-box , Chisel , WS-Tunnel , Hiddify-CLI رو نام ببرم .

